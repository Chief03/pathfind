<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Flight System Demo</title>
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="flights-enhanced.css">
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: #f3f4f6;
        }
        
        .demo-header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .demo-header h1 {
            margin: 0;
            font-size: 24px;
            color: #1f2937;
        }
        
        .demo-controls {
            margin-top: 16px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .demo-controls button {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .demo-controls button:hover {
            background: #f9fafb;
            border-color: #9ca3af;
        }
        
        .demo-info {
            background: #fef3c7;
            border: 1px solid #fbbf24;
            border-radius: 8px;
            padding: 12px 16px;
            margin: 20px;
            font-size: 14px;
            color: #92400e;
        }
        
        .flights-tab-content {
            background: white;
            margin: 20px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            min-height: 500px;
        }
    </style>
</head>
<body>
    <div class="demo-header">
        <h1>ðŸ›« Enhanced Flight System Demo</h1>
        <div class="demo-controls">
            <button onclick="setEmptyState()">Show Empty State</button>
            <button onclick="loadSampleFlights()">Load Sample Flights</button>
            <button onclick="simulateError()">Simulate Error</button>
            <button onclick="simulateLoading()">Show Loading</button>
            <button onclick="clearAll()">Clear All</button>
            <button onclick="window.flightSystem.openFlightModal()">Add Flight</button>
            <button onclick="window.flightSystem.openFlightModal('friend')">Add for Friend</button>
        </div>
    </div>
    
    <div class="demo-info">
        <strong>Demo Mode:</strong> This page demonstrates the enhanced flight system with empty states, CRUD operations, and real-time updates. 
        The backend API is configured with sample data.
    </div>
    
    <!-- Flight content container -->
    <div class="flights-tab-content">
        <!-- The flight system will be initialized here -->
    </div>
    
    <!-- Scripts -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="models/flight.model.js"></script>
    <script src="flights-enhanced.js"></script>
    
    <script>
        // Set test data
        localStorage.setItem('currentTripId', 'TRIP123');
        localStorage.setItem('currentUserId', 'user1');
        localStorage.setItem('userName', 'John Doe');
        
        // Initialize the system
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Initializing flight system...');
            if (window.flightSystem) {
                window.flightSystem.init();
            }
        });
        
        // Demo functions
        function setEmptyState() {
            const container = document.getElementById('flights-container');
            if (!container) return;
            
            // Hide all states
            ['flights-loading', 'flights-error', 'flights-list'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.classList.add('hidden');
            });
            
            // Show empty state
            const emptyState = document.getElementById('flights-empty-state');
            if (emptyState) {
                emptyState.classList.remove('hidden');
            }
        }
        
        async function loadSampleFlights() {
            // This will trigger actual API call to load flights
            if (window.flightSystem) {
                await window.flightSystem.loadFlights();
            }
        }
        
        function simulateError() {
            const container = document.getElementById('flights-container');
            if (!container) return;
            
            // Hide all states
            ['flights-loading', 'flights-empty-state', 'flights-list'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.classList.add('hidden');
            });
            
            // Show error state
            const errorState = document.getElementById('flights-error');
            if (errorState) {
                errorState.classList.remove('hidden');
            }
        }
        
        function simulateLoading() {
            const container = document.getElementById('flights-container');
            if (!container) return;
            
            // Hide all states
            ['flights-empty-state', 'flights-error', 'flights-list'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.classList.add('hidden');
            });
            
            // Show loading state
            const loadingState = document.getElementById('flights-loading');
            if (loadingState) {
                loadingState.classList.remove('hidden');
            }
            
            // Auto-load after 2 seconds
            setTimeout(() => {
                loadSampleFlights();
            }, 2000);
        }
        
        function clearAll() {
            // Clear localStorage
            localStorage.removeItem('localFlights');
            
            // Reset to empty state
            setEmptyState();
        }
        
        // Test validation
        function testValidation() {
            if (!window.FlightModel) {
                console.error('FlightModel not loaded');
                return;
            }
            
            const { FlightValidation } = window.FlightModel;
            
            // Test cases
            const testFlight = {
                tripId: 'TRIP123',
                userId: 'user1',
                airline: 'American Airlines',
                arrivalDateTime: new Date(Date.now() + 86400000).toISOString(),
                departureAirport: 'JFK',
                arrivalAirport: 'LAX',
                travelerName: 'John Doe'
            };
            
            const validation = FlightValidation.validate(testFlight);
            console.log('Validation result:', validation);
            
            // Test invalid flight
            const invalidFlight = {
                airline: 'AA',
                departureAirport: 'JFK',
                arrivalAirport: 'JFK' // Same as departure
            };
            
            const invalidValidation = FlightValidation.validate(invalidFlight);
            console.log('Invalid flight validation:', invalidValidation);
        }
        
        // Run tests
        setTimeout(testValidation, 1000);
    </script>
</body>
</html>